import{T as ne,W as S,r as l,m as ae,l as q,o as V,d as P,f as e,e as s,w as v,j as t,ab as G,L as $,s as se,u as de,a as ie,N as ce,g as U,U as ue,a6 as me,c as oe,M as Y,h as le}from"./index-5257d121.js";import{C as pe}from"./index-ee012d29.js";import{I as Z}from"./index-a99f37f1.js";import{B as N,M as te,_ as ve,I as fe,T as ee,P as _e}from"./loadingPage-d0b9612f.js";import{T as F}from"./index-0ce5dbaa.js";import{F as z}from"./index-a8f31531.js";import{S as Q}from"./index-ac72f062.js";import{T as re}from"./index-523b0d82.js";import"./transition-f4c2e5eb.js";import"./use-outside-click-507e6bef.js";const he=ne("travelling",()=>({createTravel:async h=>{try{return await S.post("tickets",h,{headers:{"Content-Type":"multipart/form-data"}})}catch(f){throw f}},deleteTravel:async h=>{try{return await S.delete("tickets/"+h.id)}catch(f){throw console.error("Failed to create Travel:",f),f}},updateTravel:async(h,f)=>{const k=h.get("id"),r=h.get("image");try{const m=await S.put("tickets/"+k,h);if(f==!0){const b=new FormData;b.append("image",r);const g=await S.post("tickets/image/"+k,b,{headers:{"Content-Type":"multipart/form-data"}})}return m}catch(m){throw m}}})),be={class:"grid grid-cols-12 gap-4 p-4"},ge={class:"col-span-12 md:col-span-6"},xe={class:"text-base text-slate-600 dark:text-slate-300"},ye={class:"col-span-12 md:col-span-6"},ke={class:"text-base text-slate-600 dark:text-slate-300"},Ve={class:"col-span-12 md:col-span-6"},Ce={class:"text-base text-slate-600 dark:text-slate-300"},$e={class:"col-span-12 md:col-span-12"},we={class:"text-base text-slate-600 dark:text-slate-300"},Ee=e("label",{class:"block mb-2"},"Descrição",-1),Te={class:"mt-2 text-danger-500 block text-sm"},De={class:"col-span-12 md:col-span-6"},Me={class:"text-base text-slate-600 dark:text-slate-300"},Ue=e("label",{class:"block mb-2"},"Imagem",-1),Pe={class:"mt-2 text-danger-500 block text-sm"},Se={class:"col-span-12 md:col-span-6"},Ie={class:"text-base text-slate-600 dark:text-slate-300"},Be={class:"mt-2 text-danger-500 block text-sm"},Fe={class:"col-span-12 md:col-span-6"},Ne={class:"text-base text-slate-600 dark:text-slate-300"},Oe={class:"col-span-12 md:col-span-6"},Re={class:"text-base text-slate-600 dark:text-slate-300"},je={class:"col-span-12 md:col-span-6"},He={class:"text-base text-slate-600 dark:text-slate-300"},Ae={class:"flex gap-5 mx-2 px-2"},Le={__name:"createModal",emits:["CreateTicketModal"],setup(O,{emit:w}){const C=l(!1),h=()=>{C.value=!C.value},f=()=>{C.value=!1},k=l(!1),r=l(""),m=l(null),b=l(""),g=l(""),y=l(""),_=l(""),x=l(""),a=l(""),d=l(""),c=l(""),R=l(""),E=l(""),T=l(""),I=l(""),j=l(""),H=l(""),D=l(""),W=l(""),M=l([]);async function J(){await S.get("/routes").then(o=>{M.value=o.data}).catch(o=>{console.error(o)})}ae(async()=>{J()});const L=q(()=>M.value.map(o=>({value:o.name,label:o.name}))),K=q(()=>M.value.map(o=>({value:o.name,label:o.name}))),X=o=>{const n=o.target.files[0];n?(m.value=n,T.value="",k.value=!0):T.value="Imagem é obrigatória"},A=()=>{let o=!0;return x.value?c.value="":(c.value="Partida é obrigatória",o=!1),a.value?R.value="":(R.value="Destino é obrigatório",o=!1),r.value?E.value="":(E.value="Descrição é obrigatória",o=!1),m.value?T.value="":(T.value="Imagem é obrigatória",o=!1),b.value?I.value="":(I.value="Data da viagem é obrigatória",o=!1),!g.value||g.value<1?(j.value="Total de lugares deve ser pelo menos 1",o=!1):j.value="",!y.value||y.value<0?(H.value="Preço é inválido",o=!1):H.value="",_.value<0||_.value>100?(D.value="Desconto deve estar entre 0 e 100",o=!1):D.value="",o},u=()=>{if(console.log(m.value),A()){const o=new FormData;o.append("from",x.value),o.append("to",a.value),o.append("description",r.value),o.append("image",m.value),o.append("data",b.value),o.append("hour",d.value),o.append("total_seats",g.value),o.append("price",y.value),o.append("discount",_.value),w("CreateTicketModal",o),f(),x.value="",a.value="",r.value="",m.value=null,b.value="",g.value="",y.value="",_.value="",d.value=""}else console.log("Formulário inválido")};return(o,n)=>(V(),P("div",null,[e("button",{onClick:h,class:"btn inline-flex justify-center btn-outline-dark"},"Novo Bilhete"),s(t(te),{title:"Novo Bilhete",label:"Novo Bilhete",activeModal:C.value,onClose:f,sizeClass:"max-w-5xl"},{default:v(()=>[e("div",be,[e("div",ge,[e("div",xe,[s(t(Q),{modelValue:x.value,"onUpdate:modelValue":n[0]||(n[0]=i=>x.value=i),error:c.value,options:t(L),label:"Partida",placeholder:"Partida"},null,8,["modelValue","error","options"])])]),e("div",ye,[e("div",ke,[s(t(Q),{modelValue:a.value,"onUpdate:modelValue":n[1]||(n[1]=i=>a.value=i),error:R.value,options:t(K),label:"Destino",placeholder:"Destino"},null,8,["modelValue","error","options"])])]),e("div",Ve,[e("div",Ce,[s(t(z),{label:"Hora de partida",name:"d3"},{default:v(()=>[s(t(G),{class:"form-control",id:"d3",placeholder:"4:30",modelValue:d.value,"onUpdate:modelValue":n[2]||(n[2]=i=>d.value=i),config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i"},error:W.value},null,8,["modelValue","error"])]),_:1})])]),e("div",$e,[e("div",we,[Ee,s(t(re),{placeholder:"Descrição breve do bilhete",modelValue:r.value,"onUpdate:modelValue":n[3]||(n[3]=i=>r.value=i),rows:"5"},null,8,["modelValue"]),e("p",Te,$(E.value),1)])]),e("div",De,[e("div",Me,[Ue,e("input",{type:"file",onChange:X,accept:"image/*"},null,32),e("p",Pe,$(T.value),1)])]),e("div",Se,[e("div",Ie,[s(t(z),{label:"Data da Viagem",name:"data"},{default:v(()=>[s(t(G),{modelValue:b.value,"onUpdate:modelValue":n[4]||(n[4]=i=>b.value=i),class:"form-control",id:"data",placeholder:"yyyy-mm-dd",error:I.value},null,8,["modelValue","error"]),e("p",Be,$(I.value),1)]),_:1})])]),e("div",Fe,[e("div",Ne,[s(t(F),{label:"Total de Lugares",type:"number",placeholder:"Número total de assentos",modelValue:g.value,"onUpdate:modelValue":n[5]||(n[5]=i=>g.value=i),error:j.value,min:"1"},null,8,["modelValue","error"])])]),e("div",Oe,[e("div",Re,[s(t(F),{label:"Preço",type:"number",placeholder:"Preço do bilhete",modelValue:y.value,"onUpdate:modelValue":n[6]||(n[6]=i=>y.value=i),error:H.value,step:"0.01",min:"0"},null,8,["modelValue","error"])])]),e("div",je,[e("div",He,[s(t(F),{label:"Desconto (%)",type:"number",placeholder:"Desconto aplicável",modelValue:_.value,"onUpdate:modelValue":n[7]||(n[7]=i=>_.value=i),error:D.value,step:"0.01",min:"0",max:"100"},null,8,["modelValue","error"])])])]),e("div",Ae,[s(t(N),{type:"button",text:"Cancelar",btnClass:"btn-outline-dark",onClick:f}),s(t(N),{text:"Cadastrar",btnClass:"btn-dark",type:"button",onClick:u})])]),_:1},8,["activeModal"])]))}},qe={class:"grid grid-cols-12 gap-4 p-4"},Ge={class:"col-span-12 md:col-span-6"},ze={class:"text-base text-slate-600 dark:text-slate-300"},Qe={class:"col-span-12 md:col-span-6"},We={class:"text-base text-slate-600 dark:text-slate-300"},Je={class:"col-span-12 md:col-span-6"},Ke={class:"text-base text-slate-600 dark:text-slate-300"},Xe={class:"col-span-12 md:col-span-12"},Ye={class:"text-base text-slate-600 dark:text-slate-300"},Ze=e("label",{class:"block mb-2"},"Descrição",-1),ea={class:"mt-2 text-danger-500 block text-sm"},aa={class:"col-span-12 md:col-span-6"},ta={class:"text-base text-slate-600 dark:text-slate-300"},oa=e("label",{class:"block mb-2"},"Imagem",-1),la={class:"mt-2 text-danger-500 block text-sm"},sa={class:"col-span-12 md:col-span-6"},ra={class:"text-base text-slate-600 dark:text-slate-300"},na={class:"mt-2 text-danger-500 block text-sm"},da={class:"col-span-12 md:col-span-6"},ia={class:"text-base text-slate-600 dark:text-slate-300"},ca={class:"col-span-12 md:col-span-6"},ua={class:"text-base text-slate-600 dark:text-slate-300"},ma={class:"col-span-12 md:col-span-6"},pa={class:"text-base text-slate-600 dark:text-slate-300"},va={class:"flex gap-5 mx-2 px-2"},fa={__name:"EditModal",props:{modalEditStatus:{type:Boolean,default:!1},initialData:{type:Object,default:()=>({})}},emits:["closeModelEdit","update"],setup(O,{emit:w}){const C=O,h=l([]),f=l(!1),k=l(""),r=l({from:"",to:"",description:"",image:null,data:"",hour:"",total_seats:"",price:"",discount:"",id:""});async function m(){await S.get("/routes").then(a=>{h.value=a.data}).catch(a=>{console.error(a)})}ae(async()=>{m()});const b=q(()=>h.value.map(a=>({value:a.name,label:a.name}))),g=q(()=>h.value.map(a=>({value:a.name,label:a.name})));se(()=>C.initialData,a=>{a&&(r.value={id:a.id||"",from:a.from||"",to:a.to||"",description:a.description||"",data:a.data||"",hour:a.hour||"",total_seats:a.total_seats||"",price:a.price||"",discount:a.discount||"",image:null})},{immediate:!0});const y=a=>{const d=a.target.files[0];d?(r.value.image=d,f.value=!0,k.value=""):k.value="Imagem é obrigatória"},_=()=>{{const a=new FormData;a.append("id",r.value.id),a.append("from",r.value.from),a.append("to",r.value.to),a.append("description",r.value.description),a.append("image",r.value.image),a.append("data",r.value.data),a.append("hour",r.value.hour),a.append("total_seats",r.value.total_seats),a.append("price",r.value.price),a.append("discount",r.value.discount),w("update",a,f.value),x()}},x=()=>{w("closeModelEdit")};return(a,d)=>(V(),P("div",null,[s(t(te),{title:"Editar Bilhete",label:"Editar Bilhete",activeModal:O.modalEditStatus,onClose:x,sizeClass:"max-w-5xl"},{default:v(()=>[e("div",qe,[e("div",Ge,[e("div",ze,[s(t(Q),{modelValue:r.value.from,"onUpdate:modelValue":d[0]||(d[0]=c=>r.value.from=c),error:a.fromError,options:t(b),label:"Partida",placeholder:"Partida"},null,8,["modelValue","error","options"])])]),e("div",Qe,[e("div",We,[s(t(Q),{modelValue:r.value.to,"onUpdate:modelValue":d[1]||(d[1]=c=>r.value.to=c),error:a.toError,options:t(g),label:"Destino",placeholder:"Destino"},null,8,["modelValue","error","options"])])]),e("div",Je,[e("div",Ke,[s(t(z),{label:"Hora de partida",name:"hour"},{default:v(()=>[s(t(G),{class:"form-control",id:"hour",placeholder:"4:30",modelValue:r.value.hour,"onUpdate:modelValue":d[2]||(d[2]=c=>r.value.hour=c),config:{enableTime:!0,noCalendar:!0,dateFormat:"H:i"},error:a.hourError},null,8,["modelValue","error"])]),_:1})])]),e("div",Xe,[e("div",Ye,[Ze,s(t(re),{placeholder:"Descrição breve do bilhete",modelValue:r.value.description,"onUpdate:modelValue":d[3]||(d[3]=c=>r.value.description=c),rows:"5"},null,8,["modelValue"]),e("p",ea,$(a.descriptionError),1)])]),e("div",aa,[e("div",ta,[oa,e("input",{type:"file",onChange:y,accept:"image/*"},null,32),e("p",la,$(k.value),1)])]),e("div",sa,[e("div",ra,[s(t(z),{label:"Data da Viagem",name:"data"},{default:v(()=>[s(t(G),{modelValue:r.value.data,"onUpdate:modelValue":d[4]||(d[4]=c=>r.value.data=c),class:"form-control",id:"data",placeholder:"yyyy-mm-dd",error:a.dataError},null,8,["modelValue","error"]),e("p",na,$(a.dataError),1)]),_:1})])]),e("div",da,[e("div",ia,[s(t(F),{label:"Total de Lugares",type:"number",placeholder:"Número total de assentos",modelValue:r.value.total_seats,"onUpdate:modelValue":d[5]||(d[5]=c=>r.value.total_seats=c),error:a.totalSeatsError,min:"1"},null,8,["modelValue","error"])])]),e("div",ca,[e("div",ua,[s(t(F),{label:"Preço",type:"number",placeholder:"Preço do bilhete",modelValue:r.value.price,"onUpdate:modelValue":d[6]||(d[6]=c=>r.value.price=c),error:a.priceError,step:"0.01",min:"0"},null,8,["modelValue","error"])])]),e("div",ma,[e("div",pa,[s(t(F),{label:"Desconto (%)",type:"number",placeholder:"Desconto aplicável",modelValue:r.value.discount,"onUpdate:modelValue":d[7]||(d[7]=c=>r.value.discount=c),error:a.discountError,step:"0.01",min:"0",max:"100"},null,8,["modelValue","error"])])])]),e("div",va,[s(t(N),{type:"button",text:"Cancelar",btnClass:"btn-outline-dark",onClick:x}),s(t(N),{text:"Salvar",btnClass:"btn-dark",type:"button",onClick:_})])]),_:1},8,["activeModal"])]))}},_a={key:0},ha={class:"md:flex justify-between pb-6 md:space-y-0 space-y-3 items-center"},ba=e("h5",null,"viagems",-1),ga={key:0},xa={style:{"text-transform":"lowercase"}},ya={key:1},ka={style:{"text-transform":"lowercase"}},Va={key:2,class:"flex justify-center"},Ca={class:"flex space-x-3 rtl:space-x-reverse"},$a=["onClick"],wa=e("span",null," Edit",-1),Ea=["onClick"],Ta=e("span",null," Edit",-1),Da=["onClick"],Ma=e("span",null,"Delete",-1),Ua={class:"py-4 px-3"},Aa={__name:"indexPage",setup(O){const w=he(),{createTravel:C,deleteTravel:h,updateTravel:f}=w,k=l(0),r=l([]);l([]);const m=de(),b=l(null),g=l(!1),y=l([]),_=l(!1);ie();const x=localStorage.getItem("sigt_user_role"),a=async()=>{try{const u=await S.get("tickets");r.value=u.data,k.value=u.data.length}catch(u){console.error("Failed to fetch courses:",u)}};ae(()=>{a()});const d=l(1),c=l(10),R=l(5),E=l("");l([{name:"view",icon:"heroicons-outline:eye"},{name:"edit",icon:"heroicons:pencil-square"},{name:"delete",icon:"heroicons-outline:trash"}]);const T=l([{value:"1",label:"1"},{value:"3",label:"3"},{value:"5",label:"5"}]),I=l([{label:"Id",field:"id"},{label:"Partida",field:"from"},{label:"Destino",field:"to"},{label:"Preco",field:"price"},{label:"Data",field:"data"},{label:"Hora da partida",field:"hour"},{label:"Action",field:"action"}]),j=async u=>{var o,n;_.value=!0;try{const i=await C(u);m.success("viagem criada com sucesso",{timeout:2e3}),a()}catch(i){if(!(i.response&&i.response.status===401)){const p=((n=(o=i.response)==null?void 0:o.data)==null?void 0:n.message)||"Ocorreu um erro desconhecido";m.error(p,{timeout:2e3})}}finally{_.value=!1}},H=u=>{b.value=u,g.value=!0},D=()=>{g.value=!1,b.value=null},W=async()=>{_.value=!0;try{(await h(b.value)).success?(m.success("usuario removido com sucesso",{timeout:2e3}),a()):m.error("Nao foi possivel remover a usuario ",{timeout:2e3})}catch(u){m.error("Nao foi possivel remover a usuario | "+u,{timeout:2e3})}finally{_.value=!1,D()}},M=l(!1),J=u=>{M.value=!0,y.value=u,console.log(y)},L=()=>{M.value=!1},K=async(u,o)=>{_.value=!0,L();try{const n=await f(u,o);if(n&&n.status===200)m.success("viagem editada com sucesso",{timeout:2e3}),a();else throw new Error("Falha ao editar a viagem")}catch(n){if(n.response&&n.response.data&&n.response.data.errors){const i=n.response.data.errors;Object.keys(i).forEach(p=>{i[p].forEach(B=>{m.error(B,{timeout:2e3})})})}}finally{_.value=!1}},X=ce(),A=l(!1);return se(()=>X.name,u=>{u==="employees.details.index"?A.value=!0:A.value=!1}),(u,o)=>{const n=oe("router-view"),i=oe("vue-good-table");return V(),P("div",null,[_.value?(V(),P("div",_a,[s(t(ve))])):U("",!0),s(n),ue(e("div",null,[s(t(pe),{noborder:""},{default:v(()=>[e("div",null,[s(t(Le),{onCreateTicketModal:j,class:"py-5"}),e("div",ha,[ba,s(t(fe),{modelValue:E.value,"onUpdate:modelValue":o[0]||(o[0]=p=>E.value=p),placeholder:"Search",type:"text",prependIcon:"heroicons-outline:search",merged:""},null,8,["modelValue"])])]),s(i,{columns:I.value,styleClass:" vgt-table bordered centered lowercase",rows:r.value,"pagination-options":{enabled:!0,perPage:c.value},"search-options":{enabled:!0,externalQuery:E.value},"select-options":{enabled:!0,selectOnCheckboxOnly:!0,selectioninfoClass:"custom-class",selectionText:"rows selected",clearSelectionText:"clear",disableSelectinfo:!0,selectAllByGroup:!0}},{"table-row":v(p=>[p.column.field=="username"?(V(),P("span",ga,[e("span",xa,$(p.row.username),1)])):U("",!0),p.column.field=="email"?(V(),P("span",ya,[e("span",ka,$(p.row.email),1)])):U("",!0),p.column.field=="action"?(V(),P("span",Va,[e("div",Ca,[t(x)=="secretary"&&p.row.role!=="admin"?(V(),Y(t(ee),{key:0,placement:"top",arrow:"",theme:"danger-500"},{button:v(()=>[e("div",{class:"action-btn",onClick:B=>u.toggleEditDelete(p.row)},[s(t(Z),{icon:"heroicons:pencil-square"})],8,$a)]),default:v(()=>[wa]),_:2},1024)):U("",!0),t(x)=="admin"?(V(),Y(t(ee),{key:1,placement:"top",arrow:"",theme:"danger-500"},{button:v(()=>[e("div",{class:"action-btn",onClick:B=>J(p.row)},[s(t(Z),{icon:"heroicons:pencil-square"})],8,Ea)]),default:v(()=>[Ta]),_:2},1024)):U("",!0),t(x)==="admin"?(V(),Y(t(ee),{key:2,placement:"top",arrow:"",theme:"danger-500"},{button:v(()=>[e("div",{class:"action-btn",onClick:B=>H(p.row)},[s(t(Z),{icon:"heroicons:trash"})],8,Da)]),default:v(()=>[Ma]),_:2},1024)):U("",!0)])])):U("",!0)]),"pagination-bottom":v(p=>[e("div",Ua,[s(t(_e),{total:k.value,current:d.value,"per-page":c.value,pageRange:R.value,onPageChanged:o[1]||(o[1]=B=>d.value=B),pageChanged:p.pageChanged,perPageChanged:p.perPageChanged,enableSearch:"",enableSelect:"",options:T.value},{default:v(()=>[le(" > ")]),_:2},1032,["total","current","per-page","pageRange","pageChanged","perPageChanged","options"])])]),_:1},8,["columns","rows","pagination-options","search-options"])]),_:1}),s(t(te),{title:"Basic Modal",label:"Modal title",activeModal:g.value,onClose:D},{footer:v(()=>[s(t(N),{text:"Cancelar",btnClass:"btn-outline-dark",onClick:D}),s(t(N),{text:"Confirmar",btnClass:"btn-dark ",onClick:W})]),default:v(()=>[le(" Lorem ipsum dolor sit amet, consec tetur adipiscing elit, sed do eiusmod tempor incididun ut . ")]),_:1},8,["activeModal"]),s(t(fa),{modalEditStatus:M.value,onCloseModelEdit:L,initialData:y.value,onUpdate:K},null,8,["modalEditStatus","initialData"])],512),[[me,!A.value]])])}}};export{Aa as default};
